\input{preamble}

\title{}
\author{Козырнов Александр Дмитриевич, ИУ7-42Б}
\date{\today}

\begin{document}
\chapter{Аппроксимация функций}

Мы хотим заменить $f(x) \to \phi(x, \overline{a})$. То есть на такую, которая наиболее
близка к исходной.

\begin{definition}
Близость функций определяется нормой: \[
      \mid\mid f(x) - \phi(x, \overline{a}) \mid  \mid 
\] 
\end{definition}

\medskip

Самая простая аппроксимация - это интерполяция.

\begin{definition}
$f(x)$ - исходная функция, а  $\phi(x,\overline{a})$ - аппроксимирующая функция.
\[
f(x) \to \phi(x,\overline{a}), \overline{a} = \{a_0,a_1,\ldots,a_{n}\} 
\] 
\end{definition}

С помощью интерполяции можно получить значение между двумя точками $x_{i}$.
Проходит аппроксимирующая функция через узлы.

Интерполяция бывает Лагранжевой или Эрмитовой.

\begin{definition}
Эрмитова интерполяция - это использование 1-й, 2-й, 3-й и так далее производные для
учета наклона аппроксимирующей функции в узле. В итоге получаем более точную функцию.
\end{definition}

\begin{definition}
Сплайн - это многочлен, который непрерывен вместе со своими 1-ми и 2-ми производные на
всей области аппроксимации.
\end{definition}

\paragraph*{Заметка.}
Если узлы неточны (например, $y \pm \delta x$), то строим методом наименьшим квадратам
(наилучшее среднее квадратичное приближение).

\section{Линейная интерполяция}

\begin{definition}
Обобщенный полином: \[
\phi(x,\overline{a}) = \sum\limits_{k=0}^{n}a_{k}\phi_{k}(x)
\] 
\end{definition}

Задача интерполяции состоит в том, чтобы так подобрать параметры, чтобы функция совпадала
 $\phi(x,\overline{a}) = y_{i}, i=\overline{0,n} \to \{a_0,a_1,\ldots,a_{n}\} $

Наиболее часто используют полином с целыми степенями:
\begin{align*}
&\phi(x,\overline{a}) = \sum\limits_{k=0}^{n}a_{k}x^{n}
&\sum\limits_{k=0}^{n}a_{k}x_{i}^{k} = y_{i}, i=\overline{0,n} \to \{a_0,a_1,\ldots,a_{n}\}    
\end{align*}

Примем это является линейной системой. Решим ее: \[
a_0 + a_1x_{i} + a_2x_1^{2} + a_3x_{i}^{3} + \ldots + a_{n}x_{i}^{n} = y_{i}
\]

\[
\begin{vmatrix}
    1 & x_{0} & x_{0}^{2} \ldots x_{0}^{n} \\
    \vdots \\
    1 & x_{n} & x_{n}^{2} \ldots x_{n}^{n} \\

\end{vmatrix} \neq 0
\] 

\subsection{Интерполяционный полином Ньютона.}

\begin{definition}
Введем понятие разделенных разностей:
\begin{gather*}
    y(x_0,x_1) = \frac{y_0-y_1}{x_0-x_1} \\
    y(x_0,x_1,x_2) = \frac{y(x_0,x_1) - y(x_1,x_2)}{x_0-x_2} \\
    \vdots \\
    y(x_0,x_1,\ldots,x_{n})=\frac{y(x_0,x_1,\ldots,x_{n-1}) - y(x_1,x_2,\ldots,x_{n})}{x_0-x_{n}}
\end{gather*}
\end{definition}

Отсюда получаем:
\begin{align*}
\Phi_{n}(x) =& y_0 + (x-x_0)y(x_0,x_1) + (x_0-x_1)(x-x_1)y(x_0,x_1,x_2) + \ldots + (x-x_0)\ldots \\
&\ldots(x-x_{n-1})y(x_0,x_1,x_2,\ldots,x_{n})
\end{align*}

В общем виде получается так: \[
y_0 + \sum\limits_{k=0}^{n}(x-x_0)(x-x_1)\ldots(x-x_{k-1})y(x_0,x_1,\ldots,x_{k})
\]

\paragraph*{Пример.}
$$
\begin{tabular}{c c c c c c}
    x & y(x) & y(x_{i}) & y(x_{i},x_{j},x_{k}) &
    y(x_{i},x_{j},x_{j}, x_{l}) & y(x_{i}, \ldots, x_{m})\\
    0 & 1 &&&&\\
      &&-0.304&&&\\
    0.25 & 0.924 && -1.128&&\\
         &&-0.868 && 0.363&\\
    0.5 & 0.707 && -0.856 && 0.149\\
        &&-1.296 && 0.512&\\
    0.75 & 0.383 &&-0.472&&\\
         &&-1.532 &&&\\
    1 & 0 &&&&\\
\end{tabular}
$$

Найти $x = 0.6$, 4-я степень полинома. Она требует 5 узлов. Берем только самые
верхние числа (Это и есть разделенные разности!!!). Получаем:
\begin{align*}
    \Phi_{n}(x) =& 1-0.304(x-0) - 1.128(x-0)(x-0.25)+0.363(x-0)(x-0.25)(x-0.5) +\\
    & + 0.149(x-0)(x-0.25)(x-0.5)(x-0.75)
\end{align*}

Отсюда $\Phi_4(0.6) \approx 0.589$ (точный результат 0.588)

\paragraph*{Заметка.} Желательно, чтобы узлы находились симметрично относительно выбора
(то есть три узла больше х и меньше х). В нашем примере 3 узла меньше х и 2 узла больше х (x = 0.6)

\medskip

Кратко подведем итоги полинома Ньютона:
\begin{itemize}
    \item[1)] Выбор конфигурации зависит от выбранного х и степени полинома (кол-во узлов равно
        степень полинома + 1.)
    \item[2)] Степени больше 5-7 обычно не применяются из-за сильных неточностей.
\end{itemize}

Что нужно сделать:
\begin{itemize}
    \item Построить конфигурацию
    \item таблицу разделенных разностей
    \item Построить полином Ньютона
\end{itemize}


\paragraph*{Замечания об обратной интерполяции.}
Пусть даны числа:
\[
\begin{matrix}
    x & y \\
    0 & 5 \\
    1 & 3.2 \\
    2 & -2.8 \\
    3 & -4 \\
\end{matrix}
\] 

Для обратной интерполяции поменяем местами столбцы x и y:
\[
\begin{matrix}
    y & x \\
    5 & 0 \\
    3.2 & 1 \\
    -2.8 & 2 \\
    -4 & 3 \\
\end{matrix}
\] 
Строим для него полином Ньютона и ищем для него x = 0. Это и есть корень. Важно, чтобы
обратная таблица функции должна быть упорядочена (сложность алгоритма будет меньше! Например, 
возрастающая последовательность).

\subsection{Полином Эрмита}
\begin{definition}
Полином Эрмита:
\[
H_{n}(x) = \Phi_{n}(x, \underbrace{x_0,x_0,\ldots,x_0}_{n_0},
\underbrace{x_1,x_1,\ldots, x_1}_{n_1}, \ldots,
\underbrace{x_{m},x_{m}, \ldots, x_{m}}_{n_{m}})
\] 
А также $x_0, x_1, \ldots, x_{m}$ повторяются по $n_0,n_1,\ldots,n_{m}$ раз соответственно.
Причем \[
\sum\limits_{k=0}^{m}n_{k}=n+1
.\]
\end{definition}

\paragraph*{Пример.} Пусть нужно построить по 2-м значениям функции и 2-м ее производным:
$$
\begin{align*}
    \scr{H}_3(x) =&\\
    \Phi_3(x,x_0,x_0,x_1,x_1) =&\\
    =& y_0 + (x-x_0)y(x_0,x_0)+ (x-x_0)(x-x_0)y(x_0,x_0,x_1) +\\
            &+(x-x_0)^2(x-x_1)y(x_0,x_0,x_1,x_1)
\end{align*}
$$

Заметим, что \[
y(x_0,x_0) = \left\frac{y_0-y_k}{x_0-x_k}\bigg|\limits_{k\to 0} = y_0'
\] 
И так далее.

\medskip

Тогда: \[
    y(x_0,x_0,x_1) = \frac{\overbrace{y(x_0,x_0)}^{y_0'} - y(x_0,x_1)}{x_0-x_1} =
    \frac{y_0' - y(x_0,x_1)}{x_0-x_1}
\] 

Общая формула производной:
\[
\Phi( \underbrace{x_0,x_0,\ldots,x_0}_{m} ) = \frac{y^{(m-1)}(x_0)}{(m-1)!}
\] 

\paragraph*{Пример.}
\[
\Phi(x_0,x_0,x_0) = \frac{y_0''}{2!}
\] 

\end{document}
